# âš¡ å¿«é€Ÿå¼€å§‹ - 5 åˆ†é’Ÿä¸Šæ‰‹ Oxc AST å­¦ä¹ 

> ç«‹å³å¼€å§‹ä½ çš„ Oxc å­¦ä¹ ä¹‹æ—…ï¼

## ğŸš€ ç«‹å³å¼€å§‹

### ç¬¬ 1 æ­¥ï¼šè¿è¡Œç¬¬ä¸€ä¸ªç¤ºä¾‹ (2 åˆ†é’Ÿ)

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/makeblock/Developer/my-git/oxc

# è¿è¡Œç¬¬ä¸€å‘¨å®Œæ•´ç¤ºä¾‹
cd learn_demo
cargo run --bin 05_ast_deep_dive
```

ä½ å°†çœ‹åˆ°ï¼š
- âœ… Day 5: AST èŠ‚ç‚¹ç»“æ„åˆ†æ
- âœ… Day 6: Visitor æ¨¡å¼åº”ç”¨
- âœ… Day 7: Arena åˆ†é…å™¨æ¼”ç¤º

### ç¬¬ 2 æ­¥ï¼šæŸ¥çœ‹ä»£ç  (3 åˆ†é’Ÿ)

```bash
# æ‰“å¼€ç¤ºä¾‹ä»£ç 
code learn_demo/src/05_ast_deep_dive.rs

# æ‰“å¼€ AST å®šä¹‰æ–‡ä»¶
code crates/oxc_ast/src/ast/js.rs
```

**å…³æ³¨ä»¥ä¸‹èŠ‚ç‚¹å®šä¹‰**ï¼š
- `Program` - ç¬¬ 28-51 è¡Œ
- `Expression` - ç¬¬ 54-153 è¡Œ
- `Statement` - ç¬¬ 1066-1100 è¡Œ
- `Function` - ç¬¬ 1686-1808 è¡Œ

---

## ğŸ“š å­¦ä¹ è·¯å¾„æ¨è

### å¦‚æœä½ æœ‰ 2 å°æ—¶

1. é˜…è¯» [Day5-7_æ·±å…¥oxc_astä¸Rustè¿›é˜¶.md](./Day5-7_æ·±å…¥oxc_astä¸Rustè¿›é˜¶.md) (60 åˆ†é’Ÿ)
2. è¿è¡Œå¹¶ä¿®æ”¹ `05_ast_deep_dive.rs` (30 åˆ†é’Ÿ)
3. æŸ¥çœ‹ [RustçŸ¥è¯†ç‚¹é€ŸæŸ¥è¡¨.md](./RustçŸ¥è¯†ç‚¹é€ŸæŸ¥è¡¨.md) (30 åˆ†é’Ÿ)

### å¦‚æœä½ æœ‰ 1 å‘¨æ—¶é—´

æŒ‰ç…§ [ç¬¬ä¸€å‘¨/README.md](./README.md) çš„å®Œæ•´è®¡åˆ’ï¼š

```
Day 1-2: Parser åŸºç¡€        â† ç†è§£ AST
   â†“
Day 3-4: Linter åŸºç¡€        â† åº”ç”¨ Visitor
   â†“
Day 5-7: oxc_ast æ·±å…¥       â† æŒæ¡æ ¸å¿ƒ
```

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ

### 1. AST (æŠ½è±¡è¯­æ³•æ ‘)

```javascript
const x = 1 + 2;
```

â†“ è§£æä¸º

```
Program
â””â”€â”€ VariableDeclaration (const)
    â””â”€â”€ VariableDeclarator
        â”œâ”€â”€ Identifier: "x"
        â””â”€â”€ BinaryExpression (+)
            â”œâ”€â”€ NumericLiteral: 1
            â””â”€â”€ NumericLiteral: 2
```

### 2. Visitor æ¨¡å¼

```rust
impl<'a> Visit<'a> for MyVisitor {
    fn visit_function(&mut self, func: &Function<'a>, _flags: ScopeFlags) {
        // è®¿é—®æ¯ä¸ªå‡½æ•°
        println!("Found function: {}", func.id.name);
    }
}
```

### 3. Arena åˆ†é…å™¨

```rust
let allocator = Allocator::default();  // åˆ›å»º Arena
let program = parser.parse().program;  // æ‰€æœ‰èŠ‚ç‚¹åœ¨ Arena ä¸Š
// å½“ allocator drop æ—¶ï¼Œä¸€æ¬¡æ€§é‡Šæ”¾æ‰€æœ‰å†…å­˜
```

---

## ğŸ”‘ å…³é”®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | ç”¨é€” | é‡è¦æ€§ |
|------|------|--------|
| `crates/oxc_ast/src/ast/js.rs` | JS AST èŠ‚ç‚¹å®šä¹‰ | â­â­â­â­â­ |
| `crates/oxc_ast_visit/src/` | Visitor trait | â­â­â­â­ |
| `crates/oxc_allocator/src/` | Arena åˆ†é…å™¨ | â­â­â­ |
| `learn_demo/src/05_ast_deep_dive.rs` | å­¦ä¹ ç¤ºä¾‹ | â­â­â­â­â­ |

---

## ğŸ’¡ å¸¸ç”¨å‘½ä»¤

```bash
# ç¼–è¯‘æ£€æŸ¥
cargo check -p learn_demo

# è¿è¡Œç¤ºä¾‹
cargo run --bin 05_ast_deep_dive

# æŸ¥çœ‹ AST å®šä¹‰
grep "pub struct Program" crates/oxc_ast/src/ast/js.rs

# æœç´¢èŠ‚ç‚¹ç±»å‹
grep -r "Expression::" crates/oxc_ast/src/ast/js.rs
```

---

## ğŸ“ å­¦ä¹ æŠ€å·§

### âœ… æ¨èåšæ³•

1. **è¾¹å­¦è¾¹åš**: è¿è¡Œç¤ºä¾‹ â†’ é˜…è¯»ä»£ç  â†’ ä¿®æ”¹å®éªŒ
2. **å¯¹ç…§å­¦ä¹ **: åŒæ—¶æ‰“å¼€æ–‡æ¡£ã€ä»£ç å’Œ AST Explorer
3. **è®°ç¬”è®°**: ä½¿ç”¨æ–‡æ¡£ä¸­çš„ç¬”è®°æ¨¡æ¿
4. **å¾ªåºæ¸è¿›**: ä¸æ‡‚å…ˆè·³è¿‡ï¼Œå¤šçœ‹å‡ é

### âŒ é¿å…é™·é˜±

1. ä¸è¦åªçœ‹æ–‡æ¡£ä¸è¿è¡Œä»£ç 
2. ä¸è¦è¯•å›¾ä¸€æ¬¡ç†è§£æ‰€æœ‰ç»†èŠ‚
3. ä¸è¦è·³è¿‡ Rust åŸºç¡€ï¼ˆæŸ¥çœ‹é€ŸæŸ¥è¡¨ï¼‰
4. ä¸è¦å¿½ç•¥ç¼–è¯‘é”™è¯¯çš„æç¤º

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

### é‡åˆ°ç¼–è¯‘é”™è¯¯

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
cargo check -p learn_demo --bin 05_ast_deep_dive

# æ¸…ç†é‡æ–°ç¼–è¯‘
cargo clean
cargo build
```

### ä¸ç†è§£æŸä¸ªæ¦‚å¿µ

1. æŸ¥çœ‹ [RustçŸ¥è¯†ç‚¹é€ŸæŸ¥è¡¨.md](./RustçŸ¥è¯†ç‚¹é€ŸæŸ¥è¡¨.md)
2. åœ¨ä»£ç ä¸­æœç´¢ç›¸å…³ç”¨æ³•
3. ä½¿ç”¨ Rust Playground å®éªŒ

### Rust è¯­æ³•é—®é¢˜

```bash
# æŸ¥çœ‹ç±»å‹ä¿¡æ¯
# åœ¨ä»£ç ä¸­æ·»åŠ ï¼š
let () = some_expression;
# ç¼–è¯‘å™¨ä¼šå‘Šè¯‰ä½ å®é™…ç±»å‹
```

---

## ğŸ“– ç›¸å…³èµ„æº

### åœ¨çº¿å·¥å…·
- [AST Explorer](https://astexplorer.net/) - å¯è§†åŒ– AST
- [Rust Playground](https://play.rust-lang.org/) - åœ¨çº¿ Rust

### æ–‡æ¡£
- [Day5-7_æ·±å…¥oxc_astä¸Rustè¿›é˜¶.md](./Day5-7_æ·±å…¥oxc_astä¸Rustè¿›é˜¶.md) - ä¸»è¦å­¦ä¹ æ–‡æ¡£
- [RustçŸ¥è¯†ç‚¹é€ŸæŸ¥è¡¨.md](./RustçŸ¥è¯†ç‚¹é€ŸæŸ¥è¡¨.md) - Rust å‚è€ƒ
- [ç¬¬ä¸€å‘¨/README.md](./README.md) - å®Œæ•´å­¦ä¹ è®¡åˆ’

---

## âš¡ 5 åˆ†é’ŸæŒ‘æˆ˜

èƒ½å¦åœ¨ 5 åˆ†é’Ÿå†…ï¼š

1. âœ… è¿è¡Œ `05_ast_deep_dive` ç¤ºä¾‹
2. âœ… åœ¨ `js.rs` ä¸­æ‰¾åˆ° `BinaryExpression` çš„å®šä¹‰
3. âœ… ç†è§£å®ƒæœ‰å“ªäº›å­—æ®µ
4. âœ… è¿è¡Œç¤ºä¾‹è§‚å¯Ÿå®ƒçš„è¾“å‡º

**è¯•è¯•çœ‹ï¼** è¿™æ˜¯æ£€éªŒç†è§£çš„æœ€å¥½æ–¹å¼ã€‚

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å®Œæˆå¿«é€Ÿå¼€å§‹åï¼š

1. **ç³»ç»Ÿå­¦ä¹ **: é˜…è¯» [Day5-7_æ·±å…¥oxc_astä¸Rustè¿›é˜¶.md](./Day5-7_æ·±å…¥oxc_astä¸Rustè¿›é˜¶.md)
2. **åŠ¨æ‰‹å®è·µ**: å®Œæˆæ–‡æ¡£ä¸­çš„ç»ƒä¹ é¢˜
3. **æ·±å…¥ç†è§£**: ä¿®æ”¹ç¤ºä¾‹ä»£ç ï¼Œè§‚å¯Ÿæ•ˆæœ
4. **æ‰©å±•å­¦ä¹ **: æŸ¥çœ‹ç¬¬äºŒå‘¨çš„å­¦ä¹ å†…å®¹

---

**è®°ä½**: å­¦ä¹ æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œäº«å—æ¢ç´¢çš„ä¹è¶£ï¼ğŸš€

æœ‰é—®é¢˜éšæ—¶æŸ¥çœ‹æ–‡æ¡£æˆ–æé—®ã€‚Good luck!

